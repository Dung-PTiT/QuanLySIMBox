<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{template}">
<head>
    <meta charset="utf-8">
    <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
    <title>Quản lý thiết bị</title>
    <link th:href="@{/css/device.css}" rel="stylesheet" type="text/css">
    <script th:src="@{/js/device.js}"></script>
    <style>
        .container-fluid {
            padding-left: 0 !important;
            padding-right: 0 !important;
        }

        .row {
            margin-left: 0 !important;
            margin-right: 0 !important;
        }

        .btn-action {
            border: none;
            border-radius: 10px;
            background-color: #fff;
        }

        .dropdown-menu {
            min-width: 10.25rem !important;
        }

        #overlay_spinner_1 {
            /*position: absolute;*/
            /*display: none;*/
            background: #ffffff;
        }

        .cv-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .spinner {
            width: 18px;
            height: 18px;
            border: 4px #c7c7c7 solid;
            border-top: 4px #0010f9 solid;
            border-radius: 50%;
            animation: sp-anime 0.8s infinite linear;
        }

        @keyframes sp-anime {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(359deg);
            }
        }

        .divDisabled {
            pointer-events: none;
            color: #c7c7c7;
        }

        .btn-action-device {
            border: none;
            border-radius: 5px;
            background-color: #ffffff;
            padding: 2px;
            margin-left: 2px;
            margin-right: 2px;
        }
    </style>
<body>
<div class="content">
    <section class="bg-light h-100" layout:fragment="content_body">
        <div class="row" style="height: 100vh; background-color: #ffffff;">
            <div class="col-sm-12 col-md-12">
                <div class="card-header">
                    <div style="justify-content: space-between; display: flex" class="mt-2">
                        <h3 class="card-title font-weight-bold mb-3 mt-2">Quản lý thiết bị</h3>
                        <div>
                            <p>
                                <img style="width:16px;height:16px;opacity: 0.5" src="./images/cpu.svg">
                                <span class="text-grey">CPU used: </span>
                                <span class="font-weight-bold" id="cpu">40</span>%</p>
                            <p>
                                <img style="width:16px;height:16px;opacity: 0.5" src="./images/ram.svg">
                                <span class="text-grey">RAM used: </span>
                                <span class="font-weight-bold" id="ram">30</span>%
                            </p>
                        </div>
                    </div>
                    <span class="card-title" style="display: flex">
                        <ul class="nav nav-tabs nav-tabs-bottom border-bottom-8 mb-0">
                            <li class="nav-item" onclick="showTab('all')">
                                <a href="#" class="nav-link pl-0 active" data-toggle="tab">
                                    <span class="text-dark font-weight-bold">Tất cả</span>
                                    <span class="badge badge-info badge-pill ml-2" id="device_all"></span>
                                </a>
                            </li>
                            <li class="nav-item ml-3" onclick="showTab('on')">
                                <a href="#" class="nav-link pl-0" data-toggle="tab">
                                    <span class="text-dark font-weight-bold">Đang hoạt động</span>
                                    <span class="badge badge-success badge-pill ml-2" id="device_on"></span>
                                </a>
                            </li>
                            <li class="nav-item ml-3" onclick="showTab('off')">
                                <a href="#" class="nav-link pl-0" data-toggle="tab">
                                    <span class="text-dark font-weight-bold">Đang tắt</span>
                                    <span class="badge badge-dark badge-pill ml-2" id="device_off"></span>
                                </a>
                            </li>
                            <span id="device_status" style="display: none">all</span>
                        </ul>
                    </span>
                    <div class="row mt-3">
                        <div class="col-12 pl-0 d-flex justify-content-between">
                            <div>
                                <div class="btn-group justify-content-center">
                                    <a href="#" class="btn btn-filter dropdown-toggle legitRipple"
                                       data-toggle="dropdown">
                                        Khay hành động
                                    </a>
                                    <div class="dropdown-menu">
                                        <div class="dropdown-item divDisabled" id="restartDevice"
                                             onclick="showRestartDeviceConfirm()">
                                            <fa class="fa fa-sync mr-2"></fa>
                                            <span>Khởi động lại</span>
                                            <span class="ml-2" style="position: absolute;right: 10px;"
                                                  id="restartDeviceNumber"></span>
                                        </div>
                                        <div class="dropdown-item divDisabled" id="turnOffDevice"
                                             onclick="showTurnoffMultiDeviceConfirm()">
                                            <fa class="fa fa-power-off mr-2"></fa>
                                            <span>Tắt</span>
                                            <span style="position: absolute;right: 10px;"
                                                  id="turnOffDeviceNumber"></span>
                                        </div>
                                        <div class="dropdown-item divDisabled" id="turnOnDevice"
                                             onclick="turnOnMultiDevice()">
                                            <fa class="fa fa-power-off mr-2"></fa>
                                            <span>Bật</span>
                                            <span style="position: absolute;right: 10px;"
                                                  id="turnOnDeviceNumber"></span>
                                        </div>
                                        <div class="dropdown-item divDisabled" id="runMultiScript"
                                             onclick="showModalMultiScript()">
                                            <fa class="fa fa-play mr-2"></fa>
                                            <span>Chạy kịch bản</span>
                                            <span style="position: absolute;right: 10px;"
                                                  id="runScriptDeviceNumber"></span>
                                        </div>
                                        <div class="dropdown-item divDisabled" id="deleteDevice"
                                             onclick="showDeleteDeviceConfirm()">
                                            <fa class="fa fa-trash-alt mr-2"></fa>
                                            <span>Xóa thiết bị</span>
                                            <span style="position: absolute;right: 10px;"
                                                  id="deleteDeviceNumber"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="ml-3 btn-group align-items-center justify-content-center">
                                    <div>
                                        <button id="btnShowAddDeviceModal" class="btn btn-filter legitRipple"
                                                onclick="showAddDeviceModal()">
                                            <fa class="fa fa-plus-circle mr-2 text-info"></fa>
                                            <span>Thêm thiết bị</span>
                                        </button>
                                    </div>
                                    <!--                                    <div id="overlay_spinner_1">-->
                                    <!--                                        <div class="cv-spinner">-->
                                    <!--                                            <span class="spinner"></span>-->
                                    <!--                                        </div>-->
                                    <!--                                    </div>-->
                                </div>
                                <div class="ml-3 btn-group justify-content-center">
                                    <div class="form-group-feedback form-group-feedback-right" style="display: flex">
                                        <input id="search_input" type="text" class="btn-filter"
                                               placeholder="Tìm kiếm thiết bị" autocomplete="off"
                                               style="width: 260px;  border-radius: 4px 0 0 4px !important; ">
                                        <button onclick="getData()" class="btn legitRipple bg-white"
                                                style="height: 34px; border: 1px solid #dddddd; border-radius: 0 4px 4px 0;
                                            border-left-color: #ffffff;">
                                            <i class="icon-search4 pb-1"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <span>Trang:</span>
                                    <select style="border-radius: 3px; height: 27px" id="selectNumberPage"></select>
                                </div>
                                <div class="ml-4">
                                    <span>Số dòng:</span>
                                    <select style="border-radius: 3px; height: 27px" id="selectNumberRecord"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive-1">
                        <table class="table table-bordered text-center">
                            <thead>
                            <tr class="text-center" style="background-color: #f2f2f2">
                                <th style=" width: 4%;"><input type="checkbox" id="select_all"
                                                               onclick="fillSelectedDeviceIdList()">
                                </th>
                                <th style=" width: 9%;">Device ID</th>
                                <th style=" width: 6%;">Hoạt động</th>
                                <th style=" width: 8%;">Trạng thái</th>
                                <th style=" width: 11%;">Ứng dụng</th>
                                <th style=" width: 12%;">Tài khoản</th>
                                <th style=" width: 12%;">Kịch bản</th>
                                <th style=" width: 12%;">Tiến trình</th>
                                <th>Tin nhắn</th>
                                <th style="width: 14%">Hành động</th>
                            </tr>
                            </thead>
                            <tbody id="device_table_body">
                            </tbody>
                        </table>
                        <div id="demo" class="row mt-2 justify-content-between">
                            <div>
                                <span>Hiển thị
                                    <span>1</span>
                                    đến
                                    <span>10</span>
                                    trong
                                    <span id="deviceTotal"></span>
                                    bản ghi
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="confirm_popup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
             aria-hidden="true" style="top: 180px!important;">
            <div class="modal-dialog" role="document" style="width: 350px">
                <div class="modal-content">
                    <div class="modal-header" style="height: 50px">
                        <h5 id="comfirm_title" class="card-title font-weight-bold">Xác nhận xóa</h5>
                    </div>
                    <div class="modal-body">
                        <p id="confirm_content">Bạn chắc chắn muốn xóa thiết bị ?</p>
                        <div class="modal-footer justify-content-end mt-4 p-0">
                            <button id="btn_ok_comfirm" type="button" class="btn bg-primary legitRipple mr-3"
                                    style="text-transform: none; width: 80px; padding: 4px 2px 4px 2px;">Xóa
                            </button>
                            <button type="button" class="btn legitRipple" data-dismiss="modal"
                                    style="text-transform: none; width: 80px; background-color: #dddddd; padding: 4px 2px 4px 2px;">
                                Hủy
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="addDevice_popup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
             aria-hidden="true" style="top: 180px!important;">
            <div class="modal-dialog" role="document" style="width: 350px">
                <div class="modal-content">
                    <div class="modal-header" style="height: 50px">
                        <h5 class="card-title font-weight-bold">Thêm thiết bị</h5>
                        <button type="button" class="close text-danger" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true" style="font-size: 26px">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="form-group row">
                                <label class="col-3 col-form-label">Số lượng</label>
                                <div class="col-9">
                                    <div class="form-group">
                                        <input id="inputNumberDevice" type="number" class="form-control"
                                               style="text-align: center"
                                               name="add_device_input" value="">
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="modal-footer justify-content-end mt-4 p-0">
                            <button type="button" class="btn bg-primary legitRipple mr-3"
                                    onclick="addDevice()"
                                    style="text-transform: none; width: 80px; padding: 4px 2px 4px 2px;">Thêm
                            </button>
                            <button type="button" class="btn legitRipple" data-dismiss="modal"
                                    style="text-transform: none; width: 80px; background-color: #dddddd; padding: 4px 2px 4px 2px;">
                                Đóng
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="viewLog_popup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
             aria-hidden="true">
            <div class="modal-dialog" role="document" style="min-width: 85vw;">
                <div class="modal-content">
                    <div class="modal-header mt-2 mb-1 ml-2 mr-2">
                        <h5 class="card-title font-weight-bold mb-2">Xem log thiết bị</h5>
                        <h5 id="log_device_title" class="card-title font-weight-bold ml-2 text-primary"></h5>
                        <button type="button" class="close text-danger" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true" style="font-size: 26px">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body pt-1">
                        <table class="table table-bordered text-center">
                            <thead>
                            <tr class="text-center" style="background-color: #f2f2f2">
                                <th style=" width: 8%;">Thời gian</th>
                                <th style=" width: 6%;">Hoạt động</th>
                                <th style=" width: 7%;">Trạng thái</th>
                                <th style=" width: 9%;">Ứng dụng</th>
                                <th style=" width: 10%;">Tài khoản</th>
                                <th style=" width: 10%;">Kịch bản</th>
                                <th style=" width: 11%;">Sim id</th>
                                <th style=" width: 10%;">Tiến trình</th>
                                <th style=" width: 14%;">Tin nhắn</th>
                                <th>Lỗi</th>
                            </tr>
                            </thead>
                            <tbody id="log_table_body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="run_script_one_device_dialog" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalLabel"
             aria-hidden="true" style="top: 40px!important;">
            <div class="modal-dialog" role="document" style="width: 700px; max-width: 700px">
                <div class="modal-content" style="background-color: #f5f5f5">
                    <div class="modal-header">
                        <h6 class="card-title font-weight-bold mb-2">Chạy kịch bản</h6>
                        <h5 id="run_script_one_device_title" class="card-title font-size-sm">
                            <span>Thiết bị: </span>
                            <span class="text-primary">127.0.0.1:6001</span>
                        </h5>
                    </div>
                    <div class="modal-body">
                        <div class="row h-100">
                            <div class="col-lg-4">
                                <p>Kịch bản</p>
                                <ul class="list-group p-0" id="li_list" style="height: 300px; overflow: auto;"></ul>
                            </div>
                            <div class="col-lg-1 align-self-center">
                                <button type="button" class="btn btn-default p-1 mt-2 bg-white"
                                        style="border: 1px solid #dddddd">
                                    <i class="icon-arrow-right13"></i>
                                </button>
                                <button type="button" class="btn btn-default p-1 mt-2 bg-white"
                                        style="border: 1px solid #dddddd">
                                    <i class="icon-arrow-left12"></i>
                                </button>
                            </div>
                            <div class="col-lg-7 bg-white p-0" style="height: 330px; overflow: auto;">
                                <table class="table bg-white">
                                    <thead>
                                    <tr class="text-left" style="background-color: #f5f5f5;">
                                        <th class="font-weight-normal text-dark" style="width: 50%">Kịch bản sẽ chạy
                                        </th>
                                        <th class="font-weight-normal text-dark" style="width: 50%">Tài khoản</th>
                                    </tr>
                                    </thead>
                                    <tbody id="body_table_script_list">

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-end mt-2">
                        <button type="button" class="btn bg-primary legitRipple mr-3"
                                id="btn_runOneScript"
                                onclick="runOneScript()"
                                style="text-transform: none; width: 80px; padding: 4px 2px 4px 2px;">Chạy
                        </button>
                        <button type="button" class="btn legitRipple" data-dismiss="modal"
                                style="text-transform: none; width: 80px; background-color: #dddddd; padding: 4px 2px 4px 2px;">
                            Đóng
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!--        <div class="modal fade" id="run_script_one_device_dialog" tabindex="-1" role="dialog"-->
        <!--             aria-labelledby="exampleModalLabel"-->
        <!--             aria-hidden="true" style="top: 180px!important;">-->
        <!--            <div class="modal-dialog" role="document" style="width: 400px">-->
        <!--                <div class="modal-content">-->
        <!--                    <div class="modal-header">-->
        <!--                        <h5 class="card-title font-weight-bold mb-2">Chạy kịch bản</h5>-->
        <!--                        <h5 id="run_script_one_device_title" class="card-title font-weight-bold ml-2 text-primary"></h5>-->
        <!--                        <button type="button" class="close text-danger" data-dismiss="modal" aria-label="Close">-->
        <!--                            <span aria-hidden="true" style="font-size: 26px">&times;</span>-->
        <!--                        </button>-->
        <!--                    </div>-->
        <!--                    <div class="modal-body">-->
        <!--                        <div class="col-12 d-flex align-items-center">-->
        <!--                            <div class="col-3">-->
        <!--                                <span>Kịch bản</span>-->
        <!--                            </div>-->
        <!--                            <select style="width: 95%; height: 27px" onchange="getAccountByScriptForOneDevice()"-->
        <!--                                    class="col-9 filterInput"-->
        <!--                                    id="one_script_select">-->
        <!--                                <option disabled selected>Chọn kịch bản</option>-->
        <!--                            </select>-->
        <!--                        </div>-->
        <!--                        <div class="col-12 d-flex mt-2">-->
        <!--                            <div class="col-3"></div>-->
        <!--                            <div class="col-9">-->
        <!--                                <span class="text-danger" style="display: none" id="error_empty_account">Không còn tài khoản rảnh cho kịch bản</span>-->
        <!--                            </div>-->
        <!--                        </div>-->
        <!--                        <div class="mt-2 col-12 d-flex align-items-center">-->
        <!--                            <div class="col-3">-->
        <!--                                <span>Tài khoản</span>-->
        <!--                            </div>-->
        <!--                            <select style="width: 95%; height: 27px" onchange="onSelectAccountForOneDevice()"-->
        <!--                                    class="col-9 filterInput"-->
        <!--                                    id="account_select">-->
        <!--                            </select>-->
        <!--                        </div>-->
        <!--                    </div>-->
        <!--                    <div class="modal-footer justify-content-end mt-2">-->
        <!--                        <button type="button" class="btn bg-primary legitRipple mr-3"-->
        <!--                                id="btn_runOneScript"-->
        <!--                                onclick="runOneScript()"-->
        <!--                                style="text-transform: none; width: 80px; padding: 4px 2px 4px 2px;">Chạy-->
        <!--                        </button>-->
        <!--                        <button type="button" class="btn legitRipple" data-dismiss="modal"-->
        <!--                                style="text-transform: none; width: 80px; background-color: #dddddd; padding: 4px 2px 4px 2px;">-->
        <!--                            Đóng-->
        <!--                        </button>-->
        <!--                    </div>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--        </div>-->
        <div class="modal fade" id="run_script_multi_device" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title font-weight-bold" id="modal_add_edit_title">Chạy kịch bản
                            <span id="amount_device_selected" class="badge badge-info badge-pill ml-2">0</span></h5>
                        <button type="button" class="close text-danger" data-dismiss="modal" style="font-size: 26px">×
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="col-12 d-flex align-items-center pl-0 pr-0">
                            <div class="col-2 pl-0">
                                <span>Kịch bản</span>
                            </div>
                            <select style="width: 95%; height: 27px" onchange="getAccountByScriptForMultiDevice()"
                                    class="col-10 filterInput"
                                    id="multi_script_select">
                                <option disabled selected>Chọn kịch bản</option>
                            </select>
                        </div>
                        <div class="col-12 d-flex mt-2">
                            <div class="col-2"></div>
                            <div class="col-10">
                                <span class="text-danger" style="display: none" id="message_find_account"></span>
                            </div>
                        </div>
                        <div class="mt-3" style="display: flex; justify-content: space-between">
                            <div>
                                <h6>Chọn tài khoản cho mỗi thiết bị</h6>
                            </div>
                            <div>
                                <button class="btn btn-filter legitRipple"
                                        style="padding: 4px 5px 4px 6px !important; border: none !important;"
                                        onclick="autoMatchDeviceWithAccount()">
                                    <span class="text-primary">Auto</span>
                                </button>

                                <button class="btn btn-filter legitRipple"
                                        style="padding: 4px 5px 4px 6px !important; border: none !important;"
                                        onclick="clearMatchDeviceWithAccount()">
                                    <span class="text-primary">Reset</span>
                                </button>
                            </div>
                        </div>
                        <form id="form_add_edit_user">
                            <div>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead>
                                        <tr style="background-color: #f1f1f1">
                                            <th style="width: 30%">
                                                <span class="pl-2">Device</span>
                                            </th>
                                            <th>
                                                <span class="pl-2">Account</span>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody id="device_account_match_body">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer justify-content-end mt-2">
                        <button type="button" class="btn bg-primary legitRipple mr-2"
                                id="btn_run_multi_script"
                                onclick="runScriptForMultiDivice()"
                                style="text-transform: none; width: 80px; padding: 4px 2px 4px 2px;">Chạy
                        </button>
                        <button type="button" class="btn legitRipple" data-dismiss="modal"
                                style="text-transform: none; width: 80px; background-color: #dddddd; padding: 4px 2px 4px 2px;">
                            Đóng
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div id="select_account_dialog" class="modal fade" tabindex="-1" aria-hidden="true"
             style="display: none; margin-top: 80px!important;">
            <div class="modal-dialog modal-xs">
                <div class="modal-content">
                    <div class="modal-header justify-content-center bg-grey-600 p-0"
                         style="height: 46px; align-items: center">
                        <h6 class="modal-title text-white font-weight-semibold">Chọn tài khoản</h6>
                    </div>
                    <div class="modal-body">
                        <!--                        <div class="mb-4">-->
                        <!--                            <div class="form-group form-group-feedback form-group-feedback-right">-->
                        <!--                                <input type="text" class="form-control ui-autocomplete-input"-->
                        <!--                                       autocomplete="off"-->
                        <!--                                       style="    border: 1px solid #dddddd !important; border-radius: 5px; padding-left: 10px">-->
                        <!--                                <div class="form-control-feedback">-->
                        <!--                                    <button class="btn" style="margin-bottom: 1px;color: #6d6d6d">-->
                        <!--                                        <i class="icon-search4 font-size-base"></i>-->
                        <!--                                    </button>-->
                        <!--                                </div>-->
                        <!--                            </div>-->
                        <!--                        </div>-->
                        <div class="col-md-8 mb-3" id="select_account_radio_group">
                            <tr>
                                <td>
                                    <span class="pl-2 font-weight-semibold text-primary">127.0.0.1:62028</span>
                                </td>
                                <td style="display:flex; align-items: center; justify-content: space-between">
                                    <div>
                                        <span class="pl-2 font-weight-semibold">dhaskd_acc1</span>
                                    </div>
                                    <button type="button" class="btn legitRipple"
                                            onclick="clickSelectAccountDialog('127.0.0.1:62028',1)"
                                            data-target="#select_account_dialog">
                                        <fa class="fa fa-pencil-alt"></fa>
                                    </button>
                                    <button type="button" class="btn legitRipple"
                                            onclick="clickSelectAccountDialog('127.0.0.1:62028',1)"
                                            data-target="#select_account_dialog">
                                        <fa class="fa fa-pencil-alt"></fa>
                                    </button>
                                </td>
                            </tr>
                        </div>
                        <div class="modal-footer justify-content-center p-0 mt-4">
                            <button type="button" class="btn bg-primary legitRipple mr-3"
                                    onclick="getAccountSelectedInRadioGroup()"
                                    style="text-transform: none; width: 80px; padding: 4px 2px 4px 2px;">Xong
                            </button>
                            <button type="button" class="btn legitRipple" data-dismiss="modal"
                                    style="text-transform: none; width: 80px; background-color: #dddddd; padding: 4px 2px 4px 2px;">
                                Hủy
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
</body>
</html>